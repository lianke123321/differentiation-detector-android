\section{Introduction}
\label{sec:introduction}

Today's mobile systems are walled gardens inside gated communities, \ie{}, locked-down operating systems running on mobile devices that interact over a closed and opaque mobile network. 
As a result, characterizing Internet traffic naturally generated by mobile devices remains an open problem. 
%\tbd{Why do we care? variety of options available, different access technologies, data plans, news OSes, new versions of applications, decreasing quota}

The key challenge is that mobile devices and their OSes provide no built-in service for monitoring and reporting \emph{all network traffic}. 
We strongly believe that a comprehensive network usage analysis must not be limited to specific mobile OSes, access technology, device manufacturer, installed applications, and user behavior. 
Previous studies are constrained by at least one of the above dimensions of mobile Internet traffic ~\cite{vallina-rod:ads,gerber:passivespeed,chen:wifi,enck:taintdroid,wang:middleboxes,sommers:cellwifi}, thus provides only partial views of network activity -- compromising network coverage. 
In this work, we are the first to present an approach that compromises none of these, potentially enabling a large-scale deployment and comprehensive view of  mobile Internet traffic across carriers, devices, applications versions, and access technologies.

%For example, researchers with privileged access to data gathered from a cellular carrier's network can 
%report on activity for a large group of users; however, this view does not cover WiFi traffic nor 
%does it speak to traffic generated through other cellular networks.~\cite{anyattstudy} Likewise, studies that instrument 
%an enterprise WiFi network can view traffic from devices subscribing to multiple cellular carriers, but not 
%the traffic flowing over cellular links~\cite{someonedidthis}. Last, researchers have used a fleet of devices running a 
%custom version of Android to perform detailed logging of network activity~\cite{mobilelab}. This can capture all of a device's network 
%traffic but is restricted to measuring Android behavior. Further, subjects must root their own devices or to 
%switch from their primary device for the duration of the study -- barriers that can limit deployment 
%size and introduce bias. 
%\tbd{JS: Concerned about all of this related work -- seems like there's a lot! Also -- why is the fact that WiFi vs Celular traffic a big deal? Apps are apps right? Data is data? I guess performance questions come up but isn't okay that the two are characterized separately? Further, meddle introduces big performance changes so...}
%\drc{TODO: make this a less detailed paragraph -- sum it all up in one sentence with three refs, then say we are the first to to avoid the 
%otherwise inherent trade-offs.}

This paper explores the opportunities for mobile traffic measurement through indirection. 
Specifically, we exploit the fact that most mobile OSes support proxying via virtual private networks (VPNs). 
By sending mobile Internet traffic through a proxy server under our control (an approach we call \platname), we can monitor all flows regardless of device, OS or access technology. 
Importantly, installing a VPN configuration requires neither a new app to be installed nor does it require special or new privileges, thus facilitating large-scale deployment on unmodified device OSes.

First we describe the implementation of a practical and scalable service for pervasive monitoring of 
Internet traffic from mobile devices.
Then we report the results of  a measurement study using this approach both in the lab environment and with a 7-month IRB-approved study of human subjects in the wild. In particular, we use the unique view from \platname to study how to classify network flows to apps and how those apps are leaking privacy-sensitive data.

Our key contributions are as follows. We describe how we implemented a proxy-based measurement system for characterizing mobile Internet traffic for iOS and Android, 
and we demonstrate that it is sufficiently transparent to avoid significantly impacting measurement results. 
\platname captures all Internet traffic generally with less than 10\% power and packet overheads, and negligible additional latency. 
We will make the \platname software and configuration details open source and publicly available.

Next, we present results from network activity recorded from controlled experiments for more than 1,200 apps (iOS and Android), 
and from human subjects during a 7-month study, comprising 21 users and 26 devices. To the best of our knowledge, this is the first study to report a holistic 
view of network traffic from real user devices running iOS and Android. These users interact with networks in 54 ASes, 9 of which as cellular; their traffic 
strongly depends on OS and access technology.

We develop new classification techniques to identify mobile apps and Web services responsible for traffic captured by \platname. Our approach correctly identifies 89.2\% of iOS and 64.1\% of Android apps and Web services. We also take a first look at classifying the traffic contained in SSL tunnels.

Using the unique view from \platname, we study privacy-sensitive information leaked by mobile apps in controlled settings and in the wild. During our experiments we observed that iOS and Android applications leak the device identifiers and other personally identifiable information such as email address in the clear. Specifically, we observe that one of the most popular iOS application used by US physicians sends the user's first name, last name, e-mail, password, and zip code in the clear. We further use our in the wild 
data to demonstrate the extent to which users are being tracked by mobile devices over time 
and across access technologies. 

Last, we designed and built a new visualization tool that allows users to track and control how 
they are being tracked. \platname{}'s \emph{ConVis} tool borrows the Mozilla project's Collusion 
interface, but applies it to all mobile device traffic. Further, it provides a visual interface that allows 
 users to specify block lists for connections based on (app, 3rd party) tuples. A demo of our tool is 
 located at \url{http://goo.gl/A17h9}.


%\item \platname allows pervasive monitoring, and we used \platname for a 7-month IRB approved study on 26 devices. The key take home is that these measurements were did not require custom OSes, ISP support, or support from marketplaces, warranty voiding of devices. 
%
%\item During our measurement study, we observe that most traffic is either compressed, or encrypted, thus limiting the opportunities for additional traffic-volume optimization. Furthermore, we observe that popular ads and analytic sites were tracking our devices.



% \item A measurement study of app behavior (both popular and otherwise) from Android and iOS. We observe \tbd{values come here}. 
% \tbd{say something about how we can directly observe differences in the network behavior of identical apps designed for different OSes.}
% \item An analysis of privacy leaks in the mobile environment. \tbd{Results based on Amy work}.
% %\eat{\item A new measurement technique for detecting ISP interference with arbitrary Web site content.}
% \item \tbd{Results from an on going IRB based study of 30 users. We use these results to compare our observations from exisiting studies. The key take home is that these measurements were did not require custom OSes, ISP support, or support from marketplaces, warranty voiding of devices.}
% \end{packeditemize}
% \eat{
% \tbd{The above is a laundry list -- can we highlight three or four things at most? Sort of macro points and get to the details later?}
% The remainder of the paper is organized as follows:
% \tbd{Things to highlight in Intro\\
% Tools\\
% Techniques\\
% Methodology\\
% Insights}
% \tbd{Justine: Primary concern is that the secondary paragraph doesn't sell this as very novel -- others have all done this before is sort of the lesson I learned there. What's new?
% After reading this, I think we need to say, "comprehensive network usage analysis" is part of what's new here - we can track users across multiple networks and platforms; this allows us to say that x fraction of traffic is over 3G and y fraction is over WiFi, that bandwidth usage changes by x percent wen moving betwen 3G and Wifi." Because it's easy to install, this means that we can study large numbers of people (given IRB constraints) with little overhead.
% One additional thing is we should call out what findings we have are new -- it doesn't matter if our methodology is new at all if we have sexy new discovery X property of network traffic/app behavior/etc.
% }}

The rest of the paper is organized as follows. 
We present an overview of \platname and describe its feasibility in \fref{sec:platform}, then describe our experiments and measurement dataset in \fref{sec:dataset}.
In  \fref{sec:classification-methodology} we study how to classify observed network flows to the mobile apps that generated them. Last, we use the 
unique view from \platname to characterize how apps leak private information in the clear and to third parties \fref{sec:characterize-app}. 
We discuss related work in \fref{sec:related} and conclude in \fref{sec:conclusion}.

%\tbd{Make these into contributions, edit text}
%
%
%Using 3 \platname{} servers, we observe traffic from 54 ASes, 9 of which are cellular. 
%First study to report a holistic view of network traffic from real user devices. We find that 
%traffic is split nearly evenly between WiFi and cellular (60/40), highlighting that focusing 
%on only one network type misses approximately half the network activity. Further, we 
%find significant differences in device usage over cell vs WiFi, indicating that studies focusing 
%on only one network type are missing a qualitatively different portion of network activity. 
%\tbd{What fraction of flows are SSL or gzip?}
%
%A previously proposed technique for classifying mobile network traffic fails to work for the 
%vast majority of apps we tested, particularly for Android apps. This is because the user-agent 
%field often is blank or contains the name of a popular third-party library. We show that combining 
%user-agent with Host fields significantly improves classification, particularly for data gathered 
%in the wild. High-precision classification of app-generated traffic, however, remains an open problem. 
%
%First characterization of SSL traffic that goes beyond using simple port numbers. We use 
%certificate information and DNS lookups to accurately identify which apps are generating HTTPS flows.
%While Google services, mail, social networks, app stores and instant messaging are the most 
%popular services, we see significant differences in the bytes consumed by each service across 
%OSes. This has significant implications for mobile service data plans.
%
%Study of PII leaked by mobile apps in controlled settings and in the wild. To the best of our knowledge, 
%we are the first to identify and disclose leakage of highly sensitive information such as usernames, 
%e-mails and passwords in plaintext for several popular iOS apps. We further use our in the wild 
%data to demonstrate the extent to which users are being tracked by mobile devices over time 
%and across access technologies. 
%
%We designed and built a new visualization tool that allows users to track and control how 
%they are being tracked. \platname{}'s \emph{ConVis} tool borrows the Mozilla project's Collusion 
%interface, but applies it to all mobile device traffic. Further, it provides a visual interface that allows 
% users to specify block lists for connections based on (app, 3rd party) tuples. A demo of our tool is 
% located at \url{http://goo.gl/A17h9}.
 


%%% Local Variables: ***
%%% mode:latex ***
%%% TeX-master: "main.tex"  ***
%%% End: ***


