baseDir<-"/user/arao/home/controlled_experiments/malware_tests/"
scriptsDir<-paste(baseDir, "/parsing-scripts/", sep="")
broLogsDir<-paste(baseDir, "/bro-results/malware-test/", sep="")
miscDir<-paste(baseDir, "/miscData/", sep="")
testID <- "dave-manual-1";
setwd(scriptsDir);


cymruResults <- paste(miscDir, "cymru_results-",testID,".txt", sep="");
cymruResults <- read.table(cymruResults, header=T, sep=" ", fill=TRUE, stringsAsFactors=FALSE,
                           quote="", row.names=NULL, comment.char="#")
malwareFamily <- paste(miscDir, "malware_family-",testID,".txt", sep="");
malwareFamily <- read.table(malwareFamily, header=T, sep=" ", fill=TRUE, stringsAsFactors=FALSE,
                            quote="", row.names=NULL, comment.char="#")
apkChecksums <- paste(miscDir, "apk_checksums-",testID,".txt", sep="");
apkChecksums <- read.table(apkChecksums, header=T, sep=" ", fill=TRUE, stringsAsFactors=FALSE,
                           quote="", row.names=NULL, comment.char="#")
timeStampData <- paste(miscDir, "malware-ts-",testID,".txt", sep="");
timestampHeaders <- c("apkName", "pkgName", "tStart", "tStartHuman", "tStop", "tStopHuman")
timeStampData <- read.table(timeStampData, header=FALSE, sep="|", fill=TRUE, stringsAsFactors=FALSE,
                            quote="", row.names=NULL)
colnames(timeStampData) <- timestampHeaders
apkMerge <- merge(cymruResults, malwareFamily)
apkMerge <- merge(apkChecksums, apkMerge)
apkMerge <- merge(timeStampData, apkMerge)
write.table(apkMerge, paste(miscDir, "apkMetaData-",testID, sep=""), sep="\t", 
            quote=F, col.names=c(colnames(apkMerge)), row.names=FALSE, fileEncoding="utf-8")