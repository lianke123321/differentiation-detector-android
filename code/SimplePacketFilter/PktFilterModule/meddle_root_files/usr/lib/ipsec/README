# strongswan calls _updown when a tunnel is created or closed.
# In _updown we signal the meddle server of changes in the tunnel (new tunnel or tunnel close). 
# We also start the packet capture
# For packet capture we need to unblock (unmask) the sigterm and sigint to ensure tcpdump closes cleanly. Due to a bash bug, tcpdump is actually invoked from a ksh script (dirty hack but it works!)
# The _updown.orig has the original files to open the firewall (ipsec) We use it to start packet capture

signal-meddle.sh - When tunnel is being created it tells the meddle server to assosciate a private IP to a given user. When the tunnel is closing down it dissassociates an IP 
pkt-capture.sh - Start the tcpdump capture
capture-wrapper.sh - A wrapper to start the tcpdump. This script unblocks the term signals. More details of the bash bug on unblocking blocked signals is available at http://www.mail-archive.com/bug-bash@gnu.org/msg08967.htm
 
